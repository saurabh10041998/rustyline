# rustyline-derive

## Cargo.toml

### ✅ Summary (bullet points)

- This is a `Cargo.toml` `[package]` section describing the crate metadata.
- `name`, `version`, `edition` → basic identity and compiler settings.
- `authors`, `description`, `repository` → human-readable metadata.
- The crate provides procedural macros for Rustyline (`#[derive(...)]` implementations).
- `keywords` and `categories` improve crates.io visibility.
- `license = "MIT"` specifies the open-source license.
- `readme` is commented out, meaning it won’t include a README during publishing.  

- `[badges]` in `Cargo.toml` adds visual status badges to the crate’s crates.io page.
- `travis-ci` and `appveyor` show CI build results for the GitHub repo.
- `maintenance = "actively-developed"` signals that the project is actively maintained.
- These fields are **informational only** and do not affect your build or code. 

```toml
[lib]
proc-macro = true
```
- \[lib\] configures library target settings.
- `roc-macro = true` marks the crate as a procedural macro crate.
- Enables writing `#[derive(...)]`, attribute macros, and custom macro logic.
- Crate becomes compiler plugin-like and is used during macro expansion.
- Required for crates like rustyline-derive that provide derive macros.  

### dependencies
- These are dependencies required to implement procedural macros.
- `syn` → parses Rust code into an AST for macro input.
- `quote` → generates Rust code from macro output.
- `proc-macro2` → provides a stable abstraction over token streams.
- `default-features = false` is used to keep the dependency graph small.
- syn features `"derive"`, `"parsing"`, `"printing"`, `"proc-macro"` enable just enough power to parse and print Rust syntax for derive macros.   

## src/lib.rs

### imports
```rust
use proc_macro::TokenStream;
use proc_macro2::TokenStream as TokenStream2;
use quote::quote;
use syn::{parse_macro_input, Data, DeriveInput, Field, Index, Path};
```
### function get_field_by_attr
- This function is used inside a procedural macro to inspect struct fields.
- It scans `#[rustyline(...)]` attributes on each field.
- It finds the field with attribute: `#[rustyline(<ident>)]`.
- Ensures there is **exactly one such field**; otherwise it panics.
- Returns `Some((field_index, field))` for the matched field.
- Returns `None` if:
    - the struct has no such field, or
    - data is not a struct.

### function field_name_or_index_token
- Function returns a token that represents the field name (if named) or field index (if unnamed).
- Used in procedural macro code generation for handling both normal and tuple structs.
- If `field.ident` is `Some`, it returns `quote!(#ident)`.
- If `field.ident` is `None`, it converts the numeric index into a `syn::Index` and returns `quote!(#index)`.
- Allows macro-generated code to work uniformly with different struct shapes.

### 
